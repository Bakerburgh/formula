var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}(function(global,factory){(typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.Formula=factory()})(this,function(){"use strict";function map(array,func){return array.map(func)}var parser=function(){var o=function o(k,v,_o,l){for(_o=_o||{},l=k.length;l--;_o[k[l]]=v){}return _o},$V0=[1,4],$V1=[1,5],$V2=[1,6],$V3=[1,7],$V4=[1,8],$V5=[1,11],$V6=[1,12],$V7=[1,13],$V8=[1,14],$V9=[1,15],$Va=[1,16],$Vb=[1,24],$Vc=[1,18],$Vd=[1,19],$Ve=[1,20],$Vf=[1,21],$Vg=[1,22],$Vh=[1,23],$Vi=[1,25],$Vj=[1,26],$Vk=[1,27],$Vl=[1,28],$Vm=[1,29],$Vn=[1,30],$Vo=[5,6,7,8,9,10,11,12,13,14,15,16,17,19,20,32,33,36],$Vp=[5,6,7,8,12,13,14,15,16,17,19,32,33,36],$Vq=[1,58],$Vr=[1,59],$Vs=[19,32,33,36],$Vt=[5,6,7,8,9,10,12,13,14,15,16,17,19,32,33,36],$Vu=[5,6,12,13,14,15,16,19,32,33,36];var parser={trace:function trace(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"=":6,"+":7,"-":8,"*":9,"/":10,"^":11,"<>":12,">":13,"<":14,">=":15,"<=":16,"&":17,"(":18,")":19,":":20,IDENT:21,SCOPE:22,func:23,array_literal:24,TRUE:25,FALSE:26,STRING:27,NUMBER:28,"%":29,range:30,param_list:31,",":32,";":33,FUNC:34,"{":35,"}":36,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"=",7:"+",8:"-",9:"*",10:"/",11:"^",12:"<>",13:">",14:"<",15:">=",16:"<=",17:"&",18:"(",19:")",20:":",21:"IDENT",22:"SCOPE",25:"TRUE",26:"FALSE",27:"STRING",28:"NUMBER",29:"%",32:",",33:";",34:"FUNC",35:"{",36:"}"},productions_:[0,[3,2],[3,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,3],[4,2],[4,3],[4,3],[4,1],[4,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,1],[30,3],[31,1],[31,3],[31,3],[23,4],[23,3],[24,3]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:case 2:return $$[$0-1];break;case 3:this.$={type:"operator",subtype:"infix-add",operands:[$$[$0-2],$$[$0]]};break;case 4:this.$={type:"operator",subtype:"infix-subtract",operands:[$$[$0-2],$$[$0]]};break;case 5:this.$={type:"operator",subtype:"infix-multiply",operands:[$$[$0-2],$$[$0]]};break;case 6:this.$={type:"operator",subtype:"infix-divide",operands:[$$[$0-2],$$[$0]]};break;case 7:this.$={type:"operator",subtype:"infix-power",operands:[$$[$0-2],$$[$0]]};break;case 8:this.$={type:"operator",subtype:"infix-ne",operands:[$$[$0-2],$$[$0]]};break;case 9:this.$={type:"operator",subtype:"infix-eq",operands:[$$[$0-2],$$[$0]]};break;case 10:this.$={type:"operator",subtype:"infix-gt",operands:[$$[$0-2],$$[$0]]};break;case 11:this.$={type:"operator",subtype:"infix-lt",operands:[$$[$0-2],$$[$0]]};break;case 12:this.$={type:"operator",subtype:"infix-gte",operands:[$$[$0-2],$$[$0]]};break;case 13:this.$={type:"operator",subtype:"infix-lte",operands:[$$[$0-2],$$[$0]]};break;case 14:this.$={type:"operator",subtype:"prefix-plus",operands:[$$[$0]]};break;case 15:this.$={type:"operator",subtype:"infix-concat",operands:[$$[$0-2],$$[$0]]};break;case 16:this.$={type:"operator",subtype:"prefix-minus",operands:[$$[$0]]};break;case 17:this.$={type:"group",exp:$$[$0-1]};break;case 18:this.$={type:"range",subtype:"local",topLeft:$$[$0-2],bottomRight:$$[$0]};break;case 19:this.$={type:"variable",name:$$[$0]};break;case 20:this.$={type:"variable",scope:$$[$0-1],name:$$[$0]};break;case 21:case 22:this.$=$$[$0];break;case 23:this.$={type:"value",subtype:"boolean",value:true};break;case 24:this.$={type:"value",subtype:"boolean",value:false};break;case 25:this.$={type:"value",subtype:"string",value:String(yytext)};break;case 26:this.$={type:"value",subtype:"number",value:$$[$0-1]/100};break;case 27:this.$={type:"value",subtype:"number",value:Number(yytext)};break;case 29:this.$=[$$[$0]];break;case 30:this.$=$$[$0-2].concat([$$[$0]]);break;case 31:this.$=$$[$0][0].subtype!=="array"?[{type:"value",subtype:"array",items:$$[$0-2]},{type:"value",subtype:"array",items:$$[$0]}]:[{type:"value",subtype:"array",items:$$[$0-2]}].concat($$[$0]);break;case 32:this.$={type:"function",name:$$[$0-3],args:$$[$0-1]};break;case 33:this.$={type:"function",name:$$[$0-2],args:[]};break;case 34:this.$={type:"value",subtype:"array",items:$$[$0-1]};break}},table:[{3:1,4:2,6:[1,3],7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{1:[3]},{5:[1,17],6:$Vb,7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,12:$Vh,13:$Vi,14:$Vj,15:$Vk,16:$Vl,17:$Vm,20:$Vn},{4:31,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:32,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:33,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:34,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},o($Vo,[2,19]),{21:[1,35]},o($Vo,[2,21]),o($Vo,[2,22]),o($Vo,[2,23]),o($Vo,[2,24]),o($Vo,[2,25]),o($Vo,[2,27],{29:[1,36]}),{18:[1,37]},{4:39,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,31:38,34:$V9,35:$Va},{1:[2,1]},{4:40,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:41,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:42,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:43,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:44,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:45,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:46,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:47,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:48,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:49,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:50,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:51,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:52,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{5:[1,53],6:$Vb,7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,12:$Vh,13:$Vi,14:$Vj,15:$Vk,16:$Vl,17:$Vm,20:$Vn},o($Vp,[2,14],{9:$Ve,10:$Vf,11:$Vg,20:$Vn}),o($Vp,[2,16],{9:$Ve,10:$Vf,11:$Vg,20:$Vn}),{6:$Vb,7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,12:$Vh,13:$Vi,14:$Vj,15:$Vk,16:$Vl,17:$Vm,19:[1,54],20:$Vn},o($Vo,[2,20]),o($Vo,[2,26]),{4:39,7:$V0,8:$V1,18:$V2,19:[1,56],21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,31:55,34:$V9,35:$Va},{32:$Vq,33:$Vr,36:[1,57]},o($Vs,[2,29],{6:$Vb,7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,12:$Vh,13:$Vi,14:$Vj,15:$Vk,16:$Vl,17:$Vm,20:$Vn}),o($Vp,[2,3],{9:$Ve,10:$Vf,11:$Vg,20:$Vn}),o($Vp,[2,4],{9:$Ve,10:$Vf,11:$Vg,20:$Vn}),o($Vt,[2,5],{11:$Vg,20:$Vn}),o($Vt,[2,6],{11:$Vg,20:$Vn}),o([5,6,7,8,9,10,11,12,13,14,15,16,17,19,32,33,36],[2,7],{20:$Vn}),o($Vu,[2,8],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,17:$Vm,20:$Vn}),o($Vu,[2,9],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,17:$Vm,20:$Vn}),o($Vu,[2,10],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,17:$Vm,20:$Vn}),o($Vu,[2,11],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,17:$Vm,20:$Vn}),o($Vu,[2,12],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,17:$Vm,20:$Vn}),o($Vu,[2,13],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,17:$Vm,20:$Vn}),o([5,6,12,13,14,15,16,17,19,32,33,36],[2,15],{7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,20:$Vn}),o($Vo,[2,18]),{1:[2,2]},o($Vo,[2,17]),{19:[1,60],32:$Vq,33:$Vr},o($Vo,[2,33]),o($Vo,[2,34]),{4:61,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,34:$V9,35:$Va},{4:39,7:$V0,8:$V1,18:$V2,21:$V3,22:$V4,23:9,24:10,25:$V5,26:$V6,27:$V7,28:$V8,31:62,34:$V9,35:$Va},o($Vo,[2,32]),o($Vs,[2,30],{6:$Vb,7:$Vc,8:$Vd,9:$Ve,10:$Vf,11:$Vg,12:$Vh,13:$Vi,14:$Vj,15:$Vk,16:$Vl,17:$Vm,20:$Vn}),o([19,36],[2,31],{32:$Vq,33:$Vr})],defaultActions:{17:[2,1],53:[2,2]},parseError:function parseError(str,hash){if(hash.recoverable){this.trace(str)}else{var error=new Error(str);error.hash=hash;throw error}},parse:function parse(input){var self=this,stack=[0],tstack=[],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;var args=lstack.slice.call(arguments,1);var lexer=Object.create(this.lexer);var sharedState={yy:{}};for(var k in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,k)){sharedState.yy[k]=this.yy[k]}}lexer.setInput(input,sharedState.yy);sharedState.yy.lexer=lexer;sharedState.yy.parser=this;if(typeof lexer.yylloc=="undefined"){lexer.yylloc={}}var yyloc=lexer.yylloc;lstack.push(yyloc);var ranges=lexer.options&&lexer.options.ranges;if(typeof sharedState.yy.parseError==="function"){this.parseError=sharedState.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n}var lex=function lex(){var token;token=lexer.lex()||EOF;if(typeof token!=="number"){token=self.symbols_[token]||token}return token};var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state]}else{if(symbol===null||typeof symbol=="undefined"){symbol=lex()}action=table[state]&&table[state][symbol]}if(typeof action==="undefined"||!action.length||!action[0]){var errStr="";expected=[];for(p in table[state]){if(this.terminals_[p]&&p>TERROR){expected.push("'"+this.terminals_[p]+"'")}}if(lexer.showPosition){errStr="Parse error on line "+(yylineno+1)+":\n"+lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'"}else{errStr="Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==EOF?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'")}this.parseError(errStr,{text:lexer.match,token:this.terminals_[symbol]||symbol,line:lexer.yylineno,loc:yyloc,expected:expected})}if(action[0]instanceof Array&&action.length>1){throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol)}switch(action[0]){case 1:stack.push(symbol);vstack.push(lexer.yytext);lstack.push(lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=lexer.yyleng;yytext=lexer.yytext;yylineno=lexer.yylineno;yyloc=lexer.yylloc;if(recovering>0){recovering--}}else{symbol=preErrorSymbol;preErrorSymbol=null}break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]}r=this.performAction.apply(yyval,[yytext,yyleng,yylineno,sharedState.yy,action[1],vstack,lstack].concat(args));if(typeof r!=="undefined"){return r}if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len)}stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true}}return true}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash)}else{throw new Error(str)}},setInput:function setInput(input,yy){this.yy=yy||this.yy||{};this._input=input;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function input(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return ch},unput:function unput(ch){var len=ch.length;var lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len);this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1){this.yylineno-=lines.length-1}var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len]}this.yyleng=this.yytext.length;return this},more:function more(){this._more=true;return this},reject:function reject(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function less(n){this.unput(this.match.slice(n))},pastInput:function pastInput(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function upcomingInput(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length)}return(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function showPosition(){var pre=this.pastInput();var c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},test_match:function test_match(match,indexed_rule){var token,lines,backup;if(this.options.backtrack_lexer){backup={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){backup.yylloc.range=this.yylloc.range.slice(0)}}lines=match[0].match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno+=lines.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,indexed_rule,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(token){return token}else if(this._backtrack){for(var k in backup){this[k]=backup[k]}return false}return false},next:function next(){if(this.done){return this.EOF}if(!this._input){this.done=true}var token,match,tempMatch,index;if(!this._more){this.yytext="";this.match=""}var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(this.options.backtrack_lexer){token=this.test_match(tempMatch,rules[i]);if(token!==false){return token}else if(this._backtrack){match=false;continue}else{return false}}else if(!this.options.flex){break}}}if(match){token=this.test_match(match,rules[index]);if(token!==false){return token}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function lex(){var r=this.next();if(r){return r}else{return this.lex()}},begin:function begin(condition){this.conditionStack.push(condition)},popState:function popState(){var n=this.conditionStack.length-1;if(n>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function _currentRules(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions["INITIAL"].rules}},topState:function topState(n){n=this.conditionStack.length-1-Math.abs(n||0);if(n>=0){return this.conditionStack[n]}else{return"INITIAL"}},pushState:function pushState(condition){this.begin(condition)},stateStackSize:function stateStackSize(){return this.conditionStack.length},options:{},performAction:function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:break;case 1:return 28;break;case 2:return 25;break;case 3:return 26;break;case 4:return 25;break;case 5:return 26;break;case 6:return 25;break;case 7:return 26;break;case 8:return 9;break;case 9:return 10;break;case 10:return 8;break;case 11:return 7;break;case 12:return 17;break;case 13:return 11;break;case 14:return 18;break;case 15:return 19;break;case 16:return">=";break;case 17:return"<=";break;case 18:return"<>";break;case 19:return"=";break;case 20:return">";break;case 21:return"<";break;case 22:return"{";break;case 23:return"}";break;case 24:return"!";break;case 25:return",";break;case 26:return":";break;case 27:return";";break;case 28:return"%";break;case 29:return 34;break;case 30:return 34;break;case 31:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-2).replace(/\"\"/g,'"');return"STRING";break;case 32:yy_.yytext=yy_.yytext.substr(2,yy_.yyleng-3).replace(/\"\"/g,'"');return"SCOPE";break;case 33:yy_.yytext=yy_.yytext.substr(1,yy_.yyleng-3).replace(/\"\"/g,'"');return"SCOPE";break;case 34:yy_.yytext=yy_.yytext.slice(0,-1);return"SCOPE";break;case 35:yy_.yytext=yy_.yytext.slice(1,-1);return"SCOPE";break;case 36:return 21;break;case 37:return 5;break;case 38:return"INVALID";break}},rules:[/^(?:\s+)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:TRUE\b)/,/^(?:FALSE\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:True\b)/,/^(?:False\b)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:&)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>=)/,/^(?:<=)/,/^(?:<>)/,/^(?:=)/,/^(?:>)/,/^(?:<)/,/^(?:\{)/,/^(?:\})/,/^(?:!)/,/^(?:,)/,/^(?::)/,/^(?:;)/,/^(?:%)/,/^(?:[A-Za-z](?=[(]))/,/^(?:[A-Za-z][A-Za-z0-9\.]+(?=[(]))/,/^(?:"(?:""|[^"])*")/,/^(?:\$'(?:''|[^'])*'!)/,/^(?:'(?:''|[^'])*'!)/,/^(?:[a-zA-Z]([a-zA-Z0-9_.$]+)?!)/,/^(?:\$([a-zA-Z])([a-zA-Z0-9_.$]+)?!)/,/^(?:([\[\]a-zA-Z0-9_.$^@\(]+))/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:true}}};return lexer}();parser.lexer=lexer;function Parser(){this.yy={}}Parser.prototype=parser;parser.Parser=Parser;return new Parser}();function parse(){return parser.parse.apply(parser,arguments)}var compiledNumber=0;function compile(exp){var ast=exp,jsCode,functionCode,f,suppress=false,precedents=[],requires=[],namespace="funcs.";if(typeof ast==="string"){ast=parse(exp)}function wrapString(s){if(s[0]=="'"&&s[s.length-1]==="'"){return s}return"'"+s+"'"}function printFuncs(items){return map(items,function(n){return"function() { return ("+compiler(n)+") }"}).join(", ")}function printItems(items){return map(items,function(n){return compiler(n)}).join(", ")}function compiler(node){var lhs=void 0,rhs=void 0;switch(node.type){case"operator":switch(node.subtype){case"prefix-plus":return namespace+"numbervalue("+printItems(node.operands)+")";case"prefix-minus":return"-"+namespace+"numbervalue("+printItems(node.operands)+")";case"infix-add":requires.push("add");return namespace+"add("+printItems(node.operands)+")";case"infix-subtract":requires.push("subtract");return namespace+"subtract("+printItems(node.operands)+")";case"infix-multiply":requires.push("multiply");return namespace+"multiply("+printItems(node.operands)+")";case"infix-divide":requires.push("divide");return namespace+"divide("+printItems(node.operands)+")";case"infix-power":requires.push("power");return namespace+"power("+printItems(node.operands)+")";case"infix-concat":requires.push("concatenate");return namespace+"concatenate("+printItems(node.operands)+")";case"infix-eq":requires.push("eq");return namespace+"eq("+printItems(node.operands)+")";case"infix-ne":requires.push("ne");return namespace+"ne("+printItems(node.operands)+")";case"infix-gt":requires.push("gt");return namespace+"gt("+printItems(node.operands)+")";case"infix-gte":requires.push("gte");return namespace+"gte("+printItems(node.operands)+")";case"infix-lt":requires.push("lt");return namespace+"lt("+printItems(node.operands)+")";case"infix-lte":requires.push("lte");return namespace+"lte("+printItems(node.operands)+")"}throw TypeException("Unknown operator: "+node.subtype);case"group":return"("+compiler(node.exp)+")";case"function":requires.push(node.name.toLowerCase()==="if"?"branch":node.name.toLowerCase());switch(node.name.toLowerCase()){case"if":return namespace+"branch( "+printFuncs(node.args)+" )";case"and":case"or":return namespace+node.name.toLowerCase()+"( "+printFuncs(node.args)+" )";default:return namespace+node.name.toLowerCase()+"( "+printItems(node.args)+" )"}case"cell":if(typeof precedents!=="undefined"&&!suppress){precedents.push(node)}return'context.get("'+node.addr+'")';case"range":if(typeof precedents!=="undefined"){precedents.push(node);suppress=true}lhs=compiler(node.topLeft);rhs=compiler(node.bottomRight);suppress=false;if(node.topLeft.type==="function"){lhs="function() { return ("+lhs+"); }"}if(node.bottomRight.type==="function"){rhs="function() { return ("+rhs+"); }"}requires.push("ref");return"this.ref( "+lhs+", "+rhs+" )";case"variable":if(precedents&&!suppress){precedents.push(node)}if(node.scope){return'context.get("'+node.name+'", "'+node.scope+'")'}return'context.get("'+node.name+'")';case"value":switch(node.subtype){case"array":return"["+printItems(node.items)+"]";case"string":return"'"+node.value.replace(/'/g,"''")+"'";default:return node.value}}}var id=compiledNumber++;var compiled=compiler(ast);f=new Function("context","funcs","/* formula: "+exp+" */\nreturn ("+compiled+");\n//# sourceURL=formula_"+id+"\n");f.id=id;f.exp=exp;f.ast=ast;f.code=compiled;f.precedents=precedents;f.requires=requires;return f}function isfunction(value){return value&&Object.prototype.toString.call(value)=="[object Function]"}function assign(initial){var func=Object.assign||assign;for(var _len=arguments.length,list=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){list[_key-1]=arguments[_key]}return func.apply(undefined,[initial].concat(list))}function istext(value){return"string"===typeof value}function FFError(message,name){this.name=name||"NotImplementedError";this.message=message||""}FFError.prototype=Error.prototype;FFError.prototype.toString=function(){return this.message};var nil=new FFError("#NULL!","Null reference");var div0=new FFError("#DIV/0!","Divide by zero");var value=new FFError("#VALUE!","Invalid value");var ref=new FFError("#REF!","Invalid reference");var name=new FFError("#NAME?","Invalid name");var num=new FFError("#NUM!","Invalid number");var na=new FFError("#N/A!","Not applicable");var error$1=new FFError("#ERROR!","Error");var data=new FFError("#GETTING_DATA!","Error getting data");var missing=new FFError("#MISSING!","Missing");var unknown=new FFError("#UNKNOWN!","Unknown error");var error$2={nil:nil,div0:div0,value:value,ref:ref,name:name,num:num,na:na,error:error$1,data:data,missing:missing,unknown:unknown};var m={};function run(exp){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var funcs=functions;if(isfunction(exp))return exp;if(!istext(exp))return error$2.na;if(m.hasOwnProperty(exp)){compiled=m[exp]}else{var compiled=compile(exp);m[exp]=compiled}var locals=assign({},params);if(locals.get!=="function"){locals.get=function(name,scope){if(typeof scope!=="undefined")return locals[scope]?locals[scope][name]:undefined;return locals[name]}}return compiled(locals,funcs)}function isnan(value){if(Number.isNaN)return Number.isNaN(value);return typeof value==="number"&&isNaN(value)}function isfalsy(value){return value===false||value===0||value===""||typeof value==="undefined"||value===null||isnan(value)}function istruthy(value){return!isfalsy(value)}function reduce(arr,func){for(var _len2=arguments.length,rest=Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++){rest[_key2-2]=arguments[_key2]}return arr.reduce.apply(arr,[func].concat(rest))}function branch(){for(var _len3=arguments.length,cases=Array(_len3),_key3=0;_key3<_len3;_key3++){cases[_key3]=arguments[_key3]}var resolved=false;return reduce(cases,function(acc,item,index){var val=void 0;if(resolved===true)return acc;if(index===cases.length-1){if(index%2===1)return;return isfunction(item)?item():item}if(index%2===0&&(isfunction(item)&&istruthy(item())||!isfunction(item)&&istruthy(item))){resolved=true;val=cases[index+1];return isfunction(val)?val():val}return acc},undefined)}function choose(index){if(!index||(arguments.length<=1?0:arguments.length-1)===0){return error$2.na}if(index<1||index>254){return error$2.value}if((arguments.length<=1?0:arguments.length-1)<index){return error$2.value}return arguments.length<=index-1+1?undefined:arguments[index-1+1]}function iserr(value){return value&&value!==error$2.na&&value.constructor&&value.constructor.name==="Error"||typeof value==="number"&&(isnan(value)||!isFinite(value))}function iserror(value){return iserr(value)||value===error$2.na}function and(){for(var _len4=arguments.length,criteria=Array(_len4),_key4=0;_key4<_len4;_key4++){criteria[_key4]=arguments[_key4]}return reduce(criteria,function(acc,item){if(iserror(acc))return acc;if(acc===0||acc===false)return false;var val=isfunction(item)?item():item;if(!(val===true||val===false||val===1||val===0)){return error$2.value}return val===true||val===1},undefined)}function or(){for(var _len5=arguments.length,criteria=Array(_len5),_key5=0;_key5<_len5;_key5++){criteria[_key5]=arguments[_key5]}return reduce(criteria,function(acc,item){if(acc===true)return true;var value=isfunction(item)?item():item;return value===true||value===1},false)}function not(value){return value!==true&&value!==false&&value!==1&&value!==0?error$2.value:!value}function eq(a,b){if(typeof a==="string"&&typeof b==="string"){return a.toLowerCase()===b.toLowerCase()}else{return a===b}}function ne(a,b){return!eq(a,b)}function isarray(value){return Object.prototype.toString.call(value)==="[object Array]"}function isblank(value){return typeof value==="undefined"||value===null}function isref(value){if(!value)return false;return value._isref===true}function gt(a,b){if(isref(a)&&isref(b)){return error$2.na}else if(isarray(a)&&isarray(b)){return error$2.na}else if(isref(a)||isarray(a)){return map(a,function(d){return d>b})}else if(isref(b)||isarray(b)){return map(a,function(d){return d>a})}else{return a>b}}function gte(a,b){if(isref(a)&&isref(b)){return error.na}else if(isarray(a)&&isarray(b)){return error.na}else if(isref(a)||isarray(a)){return map(a,function(d){return d>=b})}else if(isref(b)||isarray(b)){return map(a,function(d){return d>=a})}else{return a>=b}}function lt(a,b){if(isref(a)&&isref(b)){return error.na}else if(isarray(a)&&isarray(b)){return error.na}else if(isref(a)||isarray(a)){return map(a,function(d){return d<b})}else if(isref(b)||isarray(b)){return map(a,function(d){return d<a})}else{return a<b}}function lte(a,b){if(isref(a)&&isref(b)){return error.na}else if(isarray(a)&&isarray(b)){return error.na}else if(isref(a)||isarray(a)){return map(a,function(d){return d<=b})}else if(isref(b)||isarray(b)){return map(a,function(d){return d<=a})}else{return a<=b}}function ifblank(value,value_if_blank){return isblank(value)?value_if_blank:value}function isempty(value){return isblank(value)||isarray(value)&&value.length===0||istext(value)&&value===""}function ifempty(value,value_if_empty){return isempty(value)?value_if_empty:value}function iferror(value){var value_if_error=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return iserror(value)?value_if_error:value}function ifna(value,value_if_na){return value===error$2.na?value_if_na:value}function isboolean(val){return val===true||val===false}function isdate(value){return value&&Object.prototype.toString.call(value)=="[object Date]"}function isemail(value){var re=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(value)}function iseven(value){return!(Math.floor(Math.abs(value))&1)}var d1900=new Date(1900,0,1);var JulianOffset=2415019;var SecondsInMinute=60;var SecondsInHour=3600;var SecondsInDay=86400;var MilliSecondsInDay=864e5;var AllowedDates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"};var DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var DayNames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];var MonthNames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var AM="AM";var AM1="A";var PM="PM";var PM1="P";var τ=6.28318530717958;var MaxCols=16384;var SeparatorChar=",";var DecimalChar=".";var DefaultCurrency="$";var AllowedColors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"};function parsedate(val){function convert_date_julian_to_gregorian(juliandate){var L,N,I,J,K;L=juliandate+68569;N=Math.floor(4*L/146097);L=L-Math.floor((146097*N+3)/4);I=Math.floor(4e3*(L+1)/1461001);L=L-Math.floor(1461*I/4)+31;J=Math.floor(80*L/2447);K=L-Math.floor(2447*J/80);L=Math.floor(J/11);J=J+2-12*L;I=100*(N-49)+I+L;return new Date(I,J-1,K)}if(val instanceof Error){return val}else if(typeof val==="number"){return convert_date_julian_to_gregorian(Math.floor(val+JulianOffset))}else if(typeof val==="string"){var timestamp=Date.parse(val);if(isnan(timestamp)){return error$2.value}return new Date(timestamp)}return error$2.value}function isleapyear(val){var date=parsedate(val);var year=date.getFullYear();return year%4===0&&year%100!==0||year%400===0}function isobject(value){var type=typeof value==="undefined"?"undefined":_typeof(value);return!!value&&(type=="object"||type=="function")}function isna(value){return value===error$2.na}function isnumber(value){return typeof value==="number"&&!isNaN(value)&&isFinite(value)}function isodd(value){return!!(Math.floor(Math.abs(value))&1)}function isoweeknum(date){date=parsedate(date);if(date instanceof Error){return date}date.setHours(0,0,0);date.setDate(date.getDate()+4-(date.getDay()||7));var yearStart=new Date(date.getFullYear(),0,1);return Math.ceil(((date-yearStart)/MilliSecondsInDay+1)/7)}function isurl(str){var pattern=new RegExp("^(https?:\\/\\/)?"+"((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|"+"((\\d{1,3}\\.){3}\\d{1,3}))"+"(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*"+"(\\?[;&a-z\\d%_.~+=-]*)?"+"(\\#[-a-z\\d_]*)?$","i");return pattern.test(str)}function iswholenumber(value){return isnumber(value)&&value%1===0}function flatten(ref){if(!isarray(ref)){return error$2.value}return reduce(ref,function(a,b){return a.concat(b)},[])}function xor(){for(var _len6=arguments.length,values=Array(_len6),_key6=0;_key6<_len6;_key6++){values[_key6]=arguments[_key6]}return!!(reduce(flatten(values),function(a,b){if(b){return a+1}return a},0)&1)}function add(){for(var _len7=arguments.length,values=Array(_len7),_key7=0;_key7<_len7;_key7++){values[_key7]=arguments[_key7]}if(values.length!==2){return error$2.na}var a=values[0],b=values[1];if(!isnumber(a)||!isnumber(b)){return error$2.value}return a+b}function subtract(){for(var _len8=arguments.length,values=Array(_len8),_key8=0;_key8<_len8;_key8++){values[_key8]=arguments[_key8]}if(values.length!==2){return error$2.na}var a=values[0],b=values[1];if(!isnumber(a)||!isnumber(b)){return error$2.value}return a-b}function multiply(){for(var _len9=arguments.length,values=Array(_len9),_key9=0;_key9<_len9;_key9++){values[_key9]=arguments[_key9]}if(values.length!==2){return error$2.na}var a=values[0],b=values[1];if(!isnumber(a)||!isnumber(b)){return error$2.value}return a*b}function divide(){for(var _len10=arguments.length,values=Array(_len10),_key10=0;_key10<_len10;_key10++){values[_key10]=arguments[_key10]}if(values.length!==2){return error$2.na}var a=values[0],b=values[1];if(b===0){return error$2.div0}if(!isnumber(a)||!isnumber(b)){return error$2.value}return a/b}function abs(value){if(!isnumber(value)){return error$2.value}return Math.abs(value)}function acos(value){if(!isnumber(value)){return error$2.value}return Math.acos(value)}function acosh(value){if(!isnumber(value)){return error$2.value}return Math.log(value+Math.sqrt(value*value-1))}function acot(number){if(!isnumber(number)){return error$2.value}return Math.atan(1/number)}function acoth(number){if(!isnumber(number)){return error$2.value}return.5*Math.log((number+1)/(number-1))}function asin(number){if(!isnumber(number)){return error$2.value}return Math.asin(number)}function asinh(number){if(!isnumber(number)){return error$2.value}return Math.log(number+Math.sqrt(number*number+1))}function atan(number){if(!isnumber(number)){return error$2.value}return Math.atan(number)}function atan$1(x,y){if(!isnumber(x)||!isnumber(y)){return error$2.value}return Math.atan2(x,y)}function atan$2(x){if(!isnumber(x)){return error$2.value}return Math.log((1+x)/(1-x))/2}function cos(value){if(!isnumber(value)){return error$2.value}return Math.cos(value)}function degrees(number){if(!isnumber(number)){return error$2.value}return number*180/Math.PI}function pi$1(){return τ/2}function power(){for(var _len11=arguments.length,values=Array(_len11),_key11=0;_key11<_len11;_key11++){values[_key11]=arguments[_key11]}if(values.length!==2){return error$2.na}var val=values[0],nth=values[1];if(!isnumber(val)||!isnumber(nth)){return error$2.value}return Math.pow(val,nth)}function round(number,precision){return+number.toFixed(precision)}function roundup(number,precision){var factors=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];var factor=factors[precision];if(number>0){return Math.ceil(number*factor)/factor}else{return Math.floor(number*factor)/factor}}function sin(value){if(!isnumber(value)){return error$2.value}return Math.sin(value)}function tan(value){if(!isnumber(value)){return error$2.value}return Math.tan(value)}function tau(){return τ}function trunc(val){return val|0}function char(number){return String.fromCharCode(number)}function camelcase(value){if(!istext(value)){return error$2.value}return value.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""}).replace(/_+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})}function code(){var text=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var index=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(index<1)return error$2.na;if(text.length<index)return error$2.value;return text.charCodeAt(index-1)}function concatenate(){for(var _len12=arguments.length,values=Array(_len12),_key12=0;_key12<_len12;_key12++){values[_key12]=arguments[_key12]}return reduce(values,function(acc,item){return""+acc+item},"")}function exact(a,b){return a===b}function find(find_text){var within_text=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var position=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;position=within_text.indexOf(find_text,position-1);return position===-1?error$2.value:position+1}function join(list){var delim=arguments.length>1&&arguments[1]!==undefined?arguments[1]:", ";if(list.some(function(d){return typeof d!=="string"&&typeof d!=="number"})){return error$2.value}return list.join(delim)}function serial(date){if(!isdate(date)){return error$2.na}var diff=Math.ceil((date-d1900)/MilliSecondsInDay);return diff+(diff>59?2:1)}function n(value){if(isnumber(value)||iserror(value)){return value}if(value instanceof Date){return serial(value)}if(value===true){return 1}if(value===false){return 0}return 0}function left(text,number){if(isblank(text)){return""}if(!n(+number)){return text}return text.substring(0,number)}function len(text){if(arguments.length===0){return error$2.error}if(typeof text==="string"){return text.length}if(text.length){return text.length}return error$2.value}function lower(value){if(!istext(value))return error$2.value;return value.toLowerCase()}function split(text,delimiter){return text.split(delimiter)}function numbervalue(text,decimal_separator,group_separator){decimal_separator=decimal_separator||".";group_separator=group_separator||",";if(iserror(text)){return text}if(isempty(text)){return error$2.value}if(isnumber(text)){return text}var foundDecimal=false,len=text.length-1;if(text.length===1){if(code(text,0)<48||code(text,0)>57){return error$2.value}return+text}return reduce(split(text,""),function(acc,item,index){if(acc===error$2.value){return error$2.value}else if(len===index){if(item==="%"){return+acc/100}return+acc.concat(item)}else if(item===decimal_separator){if(foundDecimal)return error$2.value;foundDecimal=true;return acc.concat(".")}else if(item===group_separator){return acc}else if(item.charCodeAt(0)<48||item.charCodeAt(0)>57){return error$2.value}return acc.concat(item)})}function parsebool(val){if(val instanceof Error){return val}else if(typeof val==="boolean"){return val}else if(typeof val==="number"){return val!==0}else if(typeof val==="string"){var up=val.toUpperCase();if(up==="TRUE"||up==="FALSE"){return up==="TRUE"}}return error$2.value}function parsequery(){var query=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";if(typeof query!=="string"){return error$2.na}if(query.length===0){return{}}return reduce((query[0]==="?"?query.substr(1):query).split("&"),function(acc,item){var n=item.split("=");var key=decodeURIComponent(n[0]);var value=decodeURIComponent(n[1]||"");acc[key]=value;return acc},{})}function proper(text){if(text===undefined||text.length===0){return error$2.value}if(text===true){text="TRUE"}if(text===false){text="FALSE"}if(isnan(text)&&typeof text==="number"){return error$2.value}if(typeof text==="number"){text=""+text}return text.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}function replace(text,position,length,new_text){if(iserror(position)||iserror(length)||typeof text!=="string"||typeof new_text!=="string"){return error$2.value}return text.substr(0,position-1)+new_text+text.substr(position-1+length)}function right(text,number){if(isblank(text)){return""}if(!n(+number)){return text}return text.substring(text.length-number)}function rept(text,number){var r="";for(var i=0;i<number;i++){r+=text}return r}function search(find_text,within_text,position){if(!within_text){return null}position=typeof position==="undefined"?1:position;var find_exp=find_text.replace(/([^~])\?/g,"$1.").replace(/([^~])\*/g,"$1.*").replace(/([~])\?/g,"\\?").replace(/([~])\*/g,"\\*");position=new RegExp(find_exp,"i").exec(within_text);if(position){return position.index+1}return error$2.value}function snakecase(value){if(!istext(value)){return error$2.value}return value.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function substitute(text,old_text,new_text,occurrence){if(!text||!old_text||!new_text){return text}else if(occurrence===undefined){return text.replace(new RegExp(old_text,"g"),new_text)}else{var index=0;var i=0;while(text.indexOf(old_text,index)>0){index=text.indexOf(old_text,index+1);i++;if(i===occurrence){return text.substring(0,index)+new_text+text.substring(index+old_text.length)}}}}function keys(subject){return Object.keys(subject)}function substituteAll(content,locals){var start=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"-";var end=arguments.length>3&&arguments[3]!==undefined?arguments[3]:start;if(!locals)return content;return reduce(keys(locals),function(p,v){return substitute(p,""+start+v+end,locals[v])},content)}function surroundKeys(obj){var start=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"-";var end=arguments[2];end=end||start;return reduce(keys(obj),function(p,v){p[""+start+v+end]=obj[v];return p},{})}var FormatNumber={};FormatNumber.format_definitions={};FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12};FormatNumber.formatNumberWithFormat=function(rawvalue,format_string,currency_char){var scfn=FormatNumber;var op,operandstr,fromend,cval,operandstrlc;var startval,estartval;var hrs,mins,secs,ehrs,emins,esecs,ampmstr,ymd;var minOK,mpos,mspos;var result="";var format;var section,gotcomparison,compop,compval,cpos,oppos;var sectioninfo;var i,decimalscale,scaledvalue,strvalue,strparts,integervalue,fractionvalue;var integerdigits2,integerpos,fractionpos,textcolor,textstyle,separatorchar,decimalchar;var value;rawvalue=rawvalue-0;value=rawvalue;if(!isFinite(value))return"NaN";var negativevalue=value<0?1:0;if(negativevalue)value=-value;var zerovalue=value==0?1:0;currency_char=currency_char||DefaultCurrency;FormatNumber.parse_format_string(scfn.format_definitions,format_string);format=scfn.format_definitions[format_string];if(!format)throw"Format not parsed error.";section=format.sectioninfo.length-1;if(format.hascomparison){section=0;gotcomparison=0;for(cpos=0;;cpos++){op=format.operators[cpos];operandstr=format.operands[cpos];if(!op){if(gotcomparison){format_string="General";scfn.parse_format_string(scfn.format_definitions,format_string);format=scfn.format_definitions[format_string];section=0}break}if(op==scfn.commands.section){if(!gotcomparison){break}gotcomparison=0;section++;continue}if(op==scfn.commands.comparison){i=operandstr.indexOf(":");compop=operandstr.substring(0,i);compval=operandstr.substring(i+1)-0;if(compop=="<"&&rawvalue<compval||compop=="<="&&rawvalue<=compval||compop=="="&&rawvalue==compval||compop=="<>"&&rawvalue!=compval||compop==">="&&rawvalue>=compval||compop==">"&&rawvalue>compval){break}gotcomparison=1}}}else if(section>0){if(section==1){if(negativevalue){negativevalue=0;section=1}else{section=0}}else if(section==2){if(negativevalue){negativevalue=0;section=1}else if(zerovalue){section=2}else{section=0}}}sectioninfo=format.sectioninfo[section];if(sectioninfo.commas>0){for(i=0;i<sectioninfo.commas;i++){value/=1e3}}if(sectioninfo.percent>0){for(i=0;i<sectioninfo.percent;i++){value*=100}}decimalscale=1;for(i=0;i<sectioninfo.fractiondigits;i++){decimalscale*=10}scaledvalue=Math.floor(value*decimalscale+.5);scaledvalue=scaledvalue/decimalscale;if(typeof scaledvalue!="number")return"NaN";if(!isFinite(scaledvalue))return"NaN";strvalue=scaledvalue+"";if(scaledvalue==0&&(sectioninfo.fractiondigits||sectioninfo.integerdigits)){negativevalue=0}if(strvalue.indexOf("e")>=0){return rawvalue+""}strparts=strvalue.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);if(!strparts)return"NaN";integervalue=strparts[1];if(!integervalue||integervalue=="0")integervalue="";fractionvalue=strparts[2];if(!fractionvalue)fractionvalue="";if(sectioninfo.hasdate){if(rawvalue<0){return"??-???-?? ??:??:??"}startval=(rawvalue-Math.floor(rawvalue))*SecondsInDay;estartval=rawvalue*SecondsInDay;hrs=Math.floor(startval/SecondsInHour);ehrs=Math.floor(estartval/SecondsInHour);startval=startval-hrs*SecondsInHour;mins=Math.floor(startval/60);emins=Math.floor(estartval/60);secs=startval-mins*60;decimalscale=1;for(i=0;i<sectioninfo.fractiondigits;i++){decimalscale*=10}secs=Math.floor(secs*decimalscale+.5);secs=secs/decimalscale;esecs=Math.floor(estartval*decimalscale+.5);esecs=esecs/decimalscale;if(secs>=60){secs=0;mins++;emins++;if(mins>=60){mins=0;hrs++;ehrs++;if(hrs>=24){hrs=0;rawvalue++}}}fractionvalue=secs-Math.floor(secs)+"";fractionvalue=fractionvalue.substring(2);ymd=parsedate(rawvalue);ymd={year:ymd.getFullYear(),month:ymd.getMonth()+1,day:ymd.getDate()};minOK=0;mspos=sectioninfo.sectionstart;for(;;mspos++){op=format.operators[mspos];operandstr=format.operands[mspos];if(!op)break;if(op==scfn.commands.section)break;if(op==scfn.commands.date){if((operandstr.toLowerCase()=="am/pm"||operandstr.toLowerCase()=="a/p")&&!ampmstr){if(hrs>=12){if(hrs>12)hrs-=12;ampmstr=operandstr.toLowerCase()=="a/p"?PM1:PM}else{if(hrs===0)hrs=12;ampmstr=operandstr.toLowerCase()=="a/p"?AM1:AM}if(operandstr.indexOf(ampmstr)<0)ampmstr=ampmstr.toLowerCase()}if(minOK&&(operandstr=="m"||operandstr=="mm")){format.operands[mspos]+="in"}if(operandstr.charAt(0)=="h"){minOK=1}else{minOK=0}}else if(op!=scfn.commands.copy){minOK=0}}minOK=0;for(--mspos;;mspos--){op=format.operators[mspos];operandstr=format.operands[mspos];if(!op)break;if(op==scfn.commands.section)break;if(op==scfn.commands.date){if(minOK&&(operandstr=="m"||operandstr=="mm")){format.operands[mspos]+="in"}if(operandstr=="ss"){minOK=1}else{minOK=0}}else if(op!=scfn.commands.copy){minOK=0}}}integerdigits2=0;integerpos=0;fractionpos=0;textcolor="";textstyle="";separatorchar=SeparatorChar;if(separatorchar.indexOf(" ")>=0)separatorchar=separatorchar.replace(/ /g," ");decimalchar=DecimalChar;if(decimalchar.indexOf(" ")>=0)decimalchar=decimalchar.replace(/ /g," ");oppos=sectioninfo.sectionstart;while(op=format.operators[oppos]){operandstr=format.operands[oppos++];if(op==scfn.commands.copy){result+=operandstr}else if(op==scfn.commands.color){textcolor=operandstr}else if(op==scfn.commands.style){textstyle=operandstr}else if(op==scfn.commands.integer_placeholder){if(negativevalue){result+="-";negativevalue=0}integerdigits2++;if(integerdigits2==1){if(integervalue.length>sectioninfo.integerdigits){for(;integerpos<integervalue.length-sectioninfo.integerdigits;integerpos++){result+=integervalue.charAt(integerpos);if(sectioninfo.thousandssep){fromend=integervalue.length-integerpos-1;if(fromend>2&&fromend%3==0){result+=separatorchar}}}}}if(integervalue.length<sectioninfo.integerdigits&&integerdigits2<=sectioninfo.integerdigits-integervalue.length){if(operandstr=="0"||operandstr=="?"){result+=operandstr=="0"?"0":" ";if(sectioninfo.thousandssep){fromend=sectioninfo.integerdigits-integerdigits2;if(fromend>2&&fromend%3==0){result+=separatorchar}}}}else{result+=integervalue.charAt(integerpos);if(sectioninfo.thousandssep){fromend=integervalue.length-integerpos-1;if(fromend>2&&fromend%3==0){result+=separatorchar}}integerpos++}}else if(op==scfn.commands.fraction_placeholder){if(fractionpos>=fractionvalue.length){if(operandstr=="0"||operandstr=="?"){result+=operandstr=="0"?"0":" "}}else{result+=fractionvalue.charAt(fractionpos)}fractionpos++}else if(op==scfn.commands.decimal){if(negativevalue){result+="-";negativevalue=0}result+=decimalchar}else if(op==scfn.commands.currency){if(negativevalue){result+="-";negativevalue=0}result+=operandstr}else if(op==scfn.commands.general){if(value!=0){var factor=Math.floor(Math.LOG10E*Math.log(value));factor=Math.pow(10,13-factor);value=Math.floor(factor*value+.5)/factor;if(!isFinite(value))return"NaN"}if(negativevalue){result+="-"}strvalue=value+"";if(strvalue.indexOf("e")>=0){result+=strvalue;continue}strparts=strvalue.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);integervalue=strparts[1];if(!integervalue||integervalue=="0")integervalue="";fractionvalue=strparts[2];if(!fractionvalue)fractionvalue="";integerpos=0;fractionpos=0;if(integervalue.length){for(;integerpos<integervalue.length;integerpos++){result+=integervalue.charAt(integerpos);if(sectioninfo.thousandssep){fromend=integervalue.length-integerpos-1;if(fromend>2&&fromend%3==0){result+=separatorchar}}}}else{result+="0"}if(fractionvalue.length){result+=decimalchar;for(;fractionpos<fractionvalue.length;fractionpos++){result+=fractionvalue.charAt(fractionpos)}}}else if(op==scfn.commands.date){operandstrlc=operandstr.toLowerCase();if(operandstrlc=="y"||operandstrlc=="yy"){result+=(ymd.year+"").substring(2)}else if(operandstrlc=="yyyy"){result+=ymd.year+""}else if(operandstrlc=="d"){result+=ymd.day+""}else if(operandstrlc=="dd"){cval=1e3+ymd.day;result+=(cval+"").substr(2)}else if(operandstrlc=="ddd"){cval=Math.floor(rawvalue+6)%7;result+=DayNames3[cval]}else if(operandstrlc=="dddd"){cval=Math.floor(rawvalue+6)%7;result+=DayNames[cval]}else if(operandstrlc=="m"){result+=ymd.month+""}else if(operandstrlc=="mm"){cval=1e3+ymd.month;result+=(cval+"").substr(2)}else if(operandstrlc=="mmm"){result+=MonthNames3[ymd.month-1]}else if(operandstrlc=="mmmm"){result+=MonthNames[ymd.month-1]}else if(operandstrlc=="mmmmm"){result+=MonthNames[ymd.month-1].charAt(0)}else if(operandstrlc=="h"){result+=hrs+""}else if(operandstrlc=="h]"){result+=ehrs+""}else if(operandstrlc=="mmin"){cval=1e3+mins+"";result+=cval.substr(2)}else if(operandstrlc=="mm]"){if(emins<100){cval=1e3+emins+"";result+=cval.substr(2)}else{result+=emins+""}}else if(operandstrlc=="min"){result+=mins+""}else if(operandstrlc=="m]"){result+=emins+""}else if(operandstrlc=="hh"){cval=1e3+hrs+"";result+=cval.substr(2)}else if(operandstrlc=="s"){cval=Math.floor(secs);result+=cval+""}else if(operandstrlc=="ss"){cval=1e3+Math.floor(secs)+"";result+=cval.substr(2)}else if(operandstrlc=="am/pm"||operandstrlc=="a/p"){result+=ampmstr}else if(operandstrlc=="ss]"){if(esecs<100){cval=1e3+Math.floor(esecs)+"";result+=cval.substr(2)}else{cval=Math.floor(esecs);result+=cval+""}}}else if(op==scfn.commands.section){break}else if(op==scfn.commands.comparison){continue}else{result+="!! Parse error.!!"}}if(textcolor){result='<span style="color:'+textcolor+';">'+result+"</span>"}if(textstyle){result='<span style="'+textstyle+';">'+result+"</span>"}return result};FormatNumber.parse_format_string=function(format_defs,format_string){var scfn=FormatNumber;var format,section,sectioninfo;var integerpart=1;var lastwasinteger;var lastwasslash;var lastwasasterisk;var lastwasunderscore;var inquote,quotestr;var inbracket,bracketstr,bracketdata;var ingeneral,gpos;var ampmstr,part;var indate;var chpos;var ch;if(format_defs[format_string])return;format={operators:[],operands:[],sectioninfo:[{}]};format_defs[format_string]=format;section=0;sectioninfo=format.sectioninfo[section];sectioninfo.sectionstart=0;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;sectioninfo.percent=0;for(chpos=0;chpos<format_string.length;chpos++){ch=format_string.charAt(chpos);if(inquote){if(ch=='"'){inquote=0;format.operators.push(scfn.commands.copy);format.operands.push(quotestr);continue}quotestr+=ch;continue}if(inbracket){if(ch=="]"){inbracket=0;bracketdata=FormatNumber.parse_format_bracket(bracketstr);if(bracketdata.operator==scfn.commands.separator){sectioninfo.thousandssep=1;continue}if(bracketdata.operator==scfn.commands.date){sectioninfo.hasdate=1}if(bracketdata.operator==scfn.commands.comparison){format.hascomparison=1}format.operators.push(bracketdata.operator);format.operands.push(bracketdata.operand);continue}bracketstr+=ch;continue}if(lastwasslash){format.operators.push(scfn.commands.copy);format.operands.push(ch);lastwasslash=false;continue}if(lastwasasterisk){format.operators.push(scfn.commands.copy);format.operands.push(ch+ch+ch+ch+ch);lastwasasterisk=false;continue}if(lastwasunderscore){format.operators.push(scfn.commands.copy);format.operands.push(" ");lastwasunderscore=false;continue}if(ingeneral){if("general".charAt(ingeneral)==ch.toLowerCase()){ingeneral++;if(ingeneral==7){format.operators.push(scfn.commands.general);format.operands.push(ch);ingeneral=0}continue}ingeneral=0}if(indate){if(indate.charAt(0)==ch){indate+=ch;continue}format.operators.push(scfn.commands.date);format.operands.push(indate);sectioninfo.hasdate=1;indate=""}if(ampmstr){ampmstr+=ch;part=ampmstr.toLowerCase();if(part!="am/pm".substring(0,part.length)&&part!="a/p".substring(0,part.length)){ampstr=""}else if(part=="am/pm"||part=="a/p"){format.operators.push(scfn.commands.date);format.operands.push(ampmstr);ampmstr=""}continue}if(ch=="#"||ch=="0"||ch=="?"){if(integerpart){sectioninfo.integerdigits++;if(sectioninfo.commas){sectioninfo.thousandssep=1;sectioninfo.commas=0}lastwasinteger=1;format.operators.push(scfn.commands.integer_placeholder);format.operands.push(ch)}else{sectioninfo.fractiondigits++;format.operators.push(scfn.commands.fraction_placeholder);format.operands.push(ch)}}else if(ch=="."){lastwasinteger=0;format.operators.push(scfn.commands.decimal);format.operands.push(ch);integerpart=0}else if(ch==="$"){lastwasinteger=0;format.operators.push(scfn.commands.currency);format.operands.push(ch)}else if(ch==","){if(lastwasinteger){sectioninfo.commas++}else{format.operators.push(scfn.commands.copy);format.operands.push(ch)}}else if(ch=="%"){lastwasinteger=0;sectioninfo.percent++;format.operators.push(scfn.commands.copy);format.operands.push(ch)}else if(ch=='"'){lastwasinteger=0;inquote=1;quotestr=""}else if(ch=="["){lastwasinteger=0;inbracket=1;bracketstr=""}else if(ch=="\\"){lastwasslash=1;lastwasinteger=0}else if(ch=="*"){lastwasasterisk=1;lastwasinteger=0}else if(ch=="_"){lastwasunderscore=1;lastwasinteger=0}else if(ch==";"){section++;format.sectioninfo[section]={};sectioninfo=format.sectioninfo[section];sectioninfo.sectionstart=1+format.operators.length;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;sectioninfo.percent=0;integerpart=1;lastwasinteger=0;format.operators.push(scfn.commands.section);format.operands.push(ch)}else if(ch.toLowerCase()=="g"){ingeneral=1;lastwasinteger=0}else if(ch.toLowerCase()=="a"){ampmstr=ch;lastwasinteger=0}else if("dmyhHs".indexOf(ch)>=0){indate=ch}else{lastwasinteger=0;format.operators.push(scfn.commands.copy);format.operands.push(ch)}}if(indate){format.operators.push(scfn.commands.date);format.operands.push(indate);sectioninfo.hasdate=1}return};FormatNumber.parse_format_bracket=function(bracketstr){var scfn=FormatNumber;var bracketdata={};var parts;if(bracketstr.charAt(0)=="$"){bracketdata.operator=scfn.commands.currency;parts=bracketstr.match(/^\$(.+?)(\-.+?){0,1}$/);if(parts){bracketdata.operand=parts[1]||DefaultCurrency||"$"}else{bracketdata.operand=bracketstr.substring(1)||DefaultCurrency||"$"}}else if(bracketstr=="?$"){bracketdata.operator=scfn.commands.currency;bracketdata.operand="[?$]"}else if(AllowedColors[bracketstr.toUpperCase()]){bracketdata.operator=scfn.commands.color;bracketdata.operand=AllowedColors[bracketstr.toUpperCase()]}else if(parts=bracketstr.match(/^style=([^']*)$/)){bracketdata.operator=scfn.commands.style;bracketdata.operand=parts[1]}else if(bracketstr==","){bracketdata.operator=scfn.commands.separator;bracketdata.operand=bracketstr}else if(AllowedDates[bracketstr.toUpperCase()]){bracketdata.operator=scfn.commands.date;bracketdata.operand=AllowedDates[bracketstr.toUpperCase()]}else if(parts=bracketstr.match(/^[<>=]/)){parts=bracketstr.match(/^([<>=]+)(.+)$/);bracketdata.operator=scfn.commands.comparison;bracketdata.operand=parts[1]+":"+parts[2]}else{bracketdata.operator=scfn.commands.copy;bracketdata.operand="["+bracketstr+"]"}return bracketdata};function text(value,format,currency_char){return FormatNumber.formatNumberWithFormat(value,format,currency_char)}function trim(text){if(typeof text!=="string"){return error$2.value}return text.trim()}function upper(string){return string.toUpperCase()}function hlookup(needle,table){var index=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var exactmatch=arguments[3];if(typeof needle==="undefined"||isblank(needle)){return null}if(index>table.length){return error$2.ref}var needleLower=(needle+"").toLowerCase(),row=table[0];for(var i=0;i<row.length;i++){if(exactmatch&&row[i]===needle||row[i]==needle||typeof row[i]==="string"&&row[i].toLowerCase().indexOf(needleLower)!=-1){return table[index-1][i]}}return error$2.na}function includes(searchElement,searchList,fromIndex){if(searchList==null){throw new TypeError('"searchList" is null or not defined')}var o=Object(searchList);var len=o.length>>>0;if(len===0){return false}var n=fromIndex|0;var k=Math.max(n>=0?n:len-Math.abs(n),0);function sameValueZero(x,y){return x===y||typeof x==="number"&&typeof y==="number"&&isNaN(x)&&isNaN(y)}while(k<len){if(sameValueZero(o[k],searchElement)){return true}k++}return false}function index(reference,row_num){var column_num=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var row;if(!isarray(reference)||isblank(row_num)){return error$2.value}if(reference.length<row_num){return error$2.ref}row=reference[row_num-1];if(!isarray(row)){return error$2.value}if(row.length<column_num){return error$2.ref}return row[column_num-1]}function lookup(){var lookup_value,lookup_array,lookup_vector,results_vector;if(arguments.length===2){var wide=false;lookup_value=arguments[0].valueOf();lookup_array=arguments[1];for(var i=0;i<lookup_array.length;i++){if(typeof lookup_array[i]!=="undefined"&&lookup_value===lookup_array[i].valueOf()){return lookup_array[i]}}}else if(arguments.length===3){lookup_value=arguments[0].valueOf();lookup_vector=arguments[1];results_vector=arguments[2];for(var i=0;i<lookup_vector.length;i++){if(typeof lookup_vector[i]!=="undefined"&&lookup_value===lookup_vector[i].valueOf()){return results_vector[i]}}}return error.na}function match(lookup_reference,array_reference,matchType){var lookupArray,lookupValue,index,indexValue;if(arguments.length===2){matchType=1}lookupValue=lookup_reference;if(isarray(array_reference)){lookupArray=array_reference}else{return error$2.na}if(!lookupValue&&!lookupArray){return error$2.na}if(matchType!==-1&&matchType!==0&&matchType!==1){return error$2.na}for(var idx=0;idx<lookupArray.length;idx++){if(matchType===1){if(lookupArray[idx]===lookupValue){return idx+1}else if(lookupArray[idx]<lookupValue){if(!indexValue){index=idx+1;indexValue=lookupArray[idx]}else if(lookupArray[idx]>indexValue){index=idx+1;indexValue=lookupArray[idx]}}}else if(matchType===0){if(typeof lookupValue==="string"){if(idx===0){lookupValue="^"+lookupValue.replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\?")+"$"}if(typeof lookupArray[idx]!=="undefined"){if(String(lookupArray[idx]).toLowerCase().match(String(lookupValue).toLowerCase())){return idx+1}}}else{if(typeof lookupArray[idx]!=="undefined"&&lookupArray[idx]!==null&&lookupArray[idx].valueOf()===lookupValue){return idx+1}}}else if(matchType===-1){if(lookupArray[idx]===lookupValue){return idx+1}else if(lookupArray[idx]>lookupValue){if(!indexValue){index=idx+1;indexValue=lookupArray[idx]}else if(lookupArray[idx]<indexValue){index=idx+1;indexValue=lookupArray[idx]}}}}return index?index:error$2.na}function vlookup(needle){var table=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var index=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var exactmatch=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(iserror(needle)||isblank(needle)){return needle}for(var i=0;i<table.length;i++){var row=table[i];if(index>row.length){return error$2.ref}if(exactmatch&&row[0]===needle||row[0]==needle||typeof row[0]==="string"&&row[0].toLowerCase().indexOf(needle.toLowerCase())!=-1){return index<row.length+1?row[index-1]:row[0]}}return error$2.na}function date(year,month,day){return serial(new Date(year,month-1,day))}function datevalue(d){return serial(parsedate(d))}function datedif(start_date,end_date,unit){var second=1e3,minute=second*60,hour=minute*60,day=hour*24,week=day*7;start_date=parsedate(start_date),end_date=parsedate(end_date);var timediff=end_date-start_date;if(isnan(timediff))return NaN;switch(unit){case"Y":return end_date.getFullYear()-start_date.getFullYear();case"M":return end_date.getFullYear()*12+end_date.getMonth()-(start_date.getFullYear()*12+start_date.getMonth());case"W":return Math.floor(timediff/week);case"D":return Math.floor(timediff/day);case"MD":return end_date.getdate()-start_date.getdate();case"YM":return end_date.getMonth()-start_date.getMonth();case"YD":return new error("NOT IMPLEMENTED");default:return undefined}}function day(d){return parsedate(d).getDate()}function days360(start_date,end_date,method){method=parsebool(method);start_date=parsedate(start_date);end_date=parsedate(end_date);if(start_date instanceof Error){return start_date}if(end_date instanceof Error){return end_date}if(method instanceof Error){return method}var sm=start_date.getMonth();var em=end_date.getMonth();var sd,ed;if(method){sd=start_date.getDate()===31?30:start_date.getDate();ed=end_date.getDate()===31?30:end_date.getDate()}else{var smd=new Date(start_date.getFullYear(),sm+1,0).getDate();var emd=new Date(end_date.getFullYear(),em+1,0).getDate();sd=start_date.getDate()===smd?30:start_date.getDate();if(end_date.getDate()===emd){if(sd<30){em++;ed=1}else{ed=30}}else{ed=end_date.getDate()}}return 360*(end_date.getFullYear()-start_date.getFullYear())+30*(em-sm)+(ed-sd)}function edate(start_date,months){start_date=parsedate(start_date);if(start_date instanceof Error){return start_date}if(isNaN(months)){return error.value}months=parseInt(months,10);start_date.setMonth(start_date.getMonth()+months);return serial(start_date)}function eomonth(start_date,months){start_date=parsedate(start_date);if(start_date instanceof Error){return start_date}if(isNaN(months)){return error$2.value}months=parseInt(months,10);return new Date(start_date.getFullYear(),start_date.getMonth()+months+1,0)}function hour(value){return trunc((value-trunc(value))*24)}function minute(value){var totalSeconds=(value-trunc(value))*SecondsInDay;var hourSeconds=trunc(totalSeconds/SecondsInHour)*SecondsInHour;return trunc((totalSeconds-hourSeconds)/SecondsInMinute)}function month(d){return parsedate(d).getMonth()+1}function timevalue(time_text){var date=new Date("1/1/1900 "+time_text);if(date instanceof Error){return date}return(SecondsInHour*date.getHours()+SecondsInMinute*date.getMinutes()+date.getSeconds())/SecondsInDay}function now(){var d=new Date;return datevalue(d.toLocaleDateString())+timevalue(d.toLocaleTimeString())}function second(value){var totalSeconds=(value-trunc(value))*SecondsInDay;var hourSeconds=trunc(totalSeconds/SecondsInHour)*SecondsInHour;var minuteSeconds=trunc((totalSeconds-hourSeconds)/SecondsInMinute)*SecondsInMinute;return Math.round(totalSeconds-hourSeconds-minuteSeconds)}function today(){var d=new Date;return datevalue(d.toLocaleDateString())}function time(hour,minute,second){return+((hour*3600+minute*60+second)/SecondsInDay).toFixed(15)}function year(d){return parsedate(d).getFullYear()}function yearfrac(start_date,end_date,basis){start_date=parsedate(start_date);if(start_date instanceof Error){return start_date}end_date=parsedate(end_date);if(end_date instanceof Error){return end_date}basis=basis||0;var sd=start_date.getDate();var sm=start_date.getMonth()+1;var sy=start_date.getFullYear();var ed=end_date.getDate();var em=end_date.getMonth()+1;var ey=end_date.getFullYear();function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function daysBetween(a,b){return serial(b)-serial(a)}switch(basis){case 0:if(sd===31&&ed===31){sd=30;ed=30}else if(sd===31){sd=30}else if(sd===30&&ed===31){ed=30}return(ed+em*30+ey*360-(sd+sm*30+sy*360))/360;case 1:var feb29Between=function feb29Between(date1,date2){var year1=date1.getFullYear();var mar1year1=new Date(year1,2,1);if(isLeapYear(year1)&&date1<mar1year1&&date2>=mar1year1){return true}var year2=date2.getFullYear();var mar1year2=new Date(year2,2,1);return isLeapYear(year2)&&date2>=mar1year2&&date1<mar1year2};var ylength=365;if(sy===ey||sy+1===ey&&(sm>em||sm===em&&sd>=ed)){if(sy===ey&&isLeapYear(sy)||feb29Between(start_date,end_date)||em===1&&ed===29){ylength=366}return daysBetween(start_date,end_date)/ylength}var years=ey-sy+1;var days=(new Date(ey+1,0,1)-new Date(sy,0,1))/1e3/60/60/24;var average=days/years;return daysBetween(start_date,end_date)/average;case 2:return daysBetween(start_date,end_date)/360;case 3:return daysBetween(start_date,end_date)/365;case 4:return(ed+em*30+ey*360-(sd+sm*30+sy*360))/360}}function sum(){for(var _len13=arguments.length,numbers=Array(_len13),_key13=0;_key13<_len13;_key13++){numbers[_key13]=arguments[_key13]}return reduce(flatten(flatten(numbers)),function(a,b){if(typeof b!=="number"){return error$2.value}return a+b})}function average(){var v=sum.apply(undefined,arguments);if(iserror(v)){return v}return v/arguments.length}function min(){for(var _len14=arguments.length,list=Array(_len14),_key14=0;_key14<_len14;_key14++){list[_key14]=arguments[_key14]}var values=flatten(list);if(values.length===0)return;return reduce(values,function(min,next){if(isblank(min))return next;else if(isnumber(next))return Math.min(min,next);else return min})}function max(){for(var _len15=arguments.length,list=Array(_len15),_key15=0;_key15<_len15;_key15++){list[_key15]=arguments[_key15]}var values=flatten(list);if(values.length===0)return;return reduce(values,function(max,next){if(isblank(max))return next;else if(isnumber(next))return Math.max(max,next);else return max})}function filter(range){for(var _len16=arguments.length,filters=Array(_len16>1?_len16-1:0),_key16=1;_key16<_len16;_key16++){filters[_key16-1]=arguments[_key16]}function makefilter(){return function(value,index){return reduce(filters,function(previousValue,currentValue){if(previousValue===false){return false}else{return branch(isarray(currentValue),function(){return currentValue[index]},isfunction(currentValue),function(){return currentValue(value,index)},istext(currentValue),function(){return run(currentValue,value)},error$2.na)}},true)}}return range.filter(makefilter())}var filterTypes={$noop:function $noop(){return function(){return false}},$eq:function $eq(queryVal){return function(row,field){return eq(row[field],queryVal)}},$ne:function $ne(queryVal){return function(row,field){return ne(row[field],queryVal)}},$gt:function $gt(queryVal){return function(row,field){return gt(row[field],queryVal)}},$gte:function $gte(queryVal){return function(row,field){return gte(row[field],queryVal)}},$lt:function $lt(queryVal){return function(row,field){return lt(row[field],queryVal)}},$lte:function $lte(queryVal){return function(row,field){return lte(row[field],queryVal)}},$in:function $in(queryVal){return function(row,field){return isarray(queryVal)&&includes(row[field],queryVal)}},$nin:function $nin(queryVal){return function(row,field){return isarray(queryVal)&&!includes(row[field],queryVal)}},$text:function $text(queryVal){return function(row,field){return search(queryVal,row[field])>0}},$exists:function $exists(queryVal){return function(row,field){return istruthy(queryVal)?row.hasOwnProperty(field):!row.hasOwnProperty(field)}},$and:function $and(queryVal){return function(row,field){return true}},$or:function $or(queryVal){return function(row,field){return true}}};function query(data,query){var comparison=function comparison(field,op,value){return function(row){return(filterTypes[op]||filterTypes["$noop"])(value)(row,field)}};var comparator=function comparator(list,key){return function(row){return branch(isobject(list[key]),function(){return and.apply(undefined,_toConsumableArray(map(keys(list[key]),function(d){return comparison(key,d,list[key][d])(row)})))},function(){return comparison(key,"$eq",list[key])(row)})}};var comparisonGroup=function comparisonGroup(row,list,key){var op=arguments.length>3&&arguments[3]!==undefined?arguments[3]:and;if(!isarray(list[key])){throw new Error("$"+op.name+" expects array!")}return op.apply(undefined,_toConsumableArray(map(list[key],function(d){return op.apply(undefined,_toConsumableArray(map(keys(d),function(e){return comparator(d,e)(row)})))})))};var composeQuery=function composeQuery(list){return reduce(keys(list),function(funcs,key){return funcs.concat(function(row){return branch(key==="$and",function(){return comparisonGroup(row,list,key,and)},key==="$or",function(){return comparisonGroup(row,list,key,or)},function(){return comparator(list,key)(row)})})},[])};var funcs=composeQuery(query);return filter.apply(undefined,[data].concat(_toConsumableArray(map(funcs,function(filter){return map(data,function(row){return filter(row)})}))))}function accrint(issue,first,settlement,rate,par,frequency){var basis=arguments.length>6&&arguments[6]!==undefined?arguments[6]:0;var issueDate=parsedate(issue);var firstDate=parsedate(first);var settlementDate=parsedate(settlement);if(!isdate(issueDate)||!isdate(firstDate)||!isdate(settlementDate)||!isnumber(par)){return error$2.value}if(rate<=0||par<=0){return error$2.num}if([1,2,4].indexOf(frequency)===-1){return error$2.num}if([0,1,2,3,4].indexOf(basis)===-1){return error$2.num}if(settlementDate<=issueDate){return error$2.num}return par*rate*yearfrac(issue,settlement,basis)}function fv(rate,periods,payment){var value=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var type=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(isblank(rate))return error$2.na;if(isblank(periods))return error$2.na;if(isblank(payment))return error$2.na;var fv;if(rate===0){fv=value+payment*periods}else{var term=Math.pow(1+rate,periods);if(type===1){fv=value*term+payment*(1+rate)*(term-1)/rate}else{fv=value*term+payment*(term-1)/rate}}return-fv}function nper(rate,pmt,pv,fv,type){var log,result;rate=parseFloat(rate||0);pmt=parseFloat(pmt||0);pv=parseFloat(pv||0);fv=fv||0;type=type||0;log=function log(prim){if(isnan(prim)){return Math.log(0)}var num=Math.log(prim);return num};if(rate==0){result=-(pv+fv)/pmt}else if(type>0){result=log(-(rate*fv-pmt*(1+rate))/(rate*pv+pmt*(1+rate)))/log(1+rate)}else{result=log(-(rate*fv-pmt)/(rate*pv+pmt))/log(1+rate)}if(isnan(result)){result=0}return result}function npv(rate){rate=rate*1;var factor=1,sum=0;for(var _len17=arguments.length,values=Array(_len17>1?_len17-1:0),_key17=1;_key17<_len17;_key17++){values[_key17-1]=arguments[_key17]}for(var i=0;i<values.length;i++){var factor=factor*(1+rate);sum+=values[i]/factor}return sum}function pmt(rate,periods,present){var future=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var type=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(!isnumber(rate)||!isnumber(periods)){return error$2.value}if(rate===0){return-((present+future)/periods)}else{var term=Math.pow(1+rate,periods);if(type===1){return-((future*rate/(term-1)+present*rate/(1-1/term))/(1+rate))}else{return-(future*rate/(term-1)+present*rate/(1-1/term))}}}function pv(rate,periods,payment){var future=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var type=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(isblank(rate))return error$2.na;if(isblank(periods))return error$2.na;if(isblank(payment))return error$2.na;if(rate===0){return-payment*periods-future}else{return((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)}}function bin2dec(value){var valueAsString;if(typeof value==="string"){valueAsString=value}else if(typeof value!=="undefined"){valueAsString=value.toString()}else{return error$2.NA}if(valueAsString.length>10)return error$2.NUM;if(valueAsString.length===10&&valueAsString[0]==="1"){return parseInt(valueAsString.substring(1),2)-512}return parseInt(valueAsString,2)}function dec2bin(input,places){if(input instanceof Error){return number}var number=parseInt(input);if(!/^-?[0-9]{1,3}$/.test(number)||isnan(number)){return error$2.value}if(number<-512||number>511){return error$2.num}if(number<0){return"1"+rept("0",9-(512+number).toString(2).length)+(512+number).toString(2)}var result=parseInt(number,10).toString(2);if(typeof places==="undefined"){return result}else{if(!/^-?[0-9]{1,3}$/.test(places)||isnan(places)){return error$2.value}if(places<0){return error$2.num}places=Math.floor(places);return places>=result.length?rept("0",places-result.length)+result:error$2.num}}function oct2dec(octalNumber){if(!/^[0-7]{1,10}$/.test(octalNumber))return error$2.num;var nonNegativeDecimalNumber=parseInt(octalNumber,8);return nonNegativeDecimalNumber>=536870912?nonNegativeDecimalNumber-1073741824:nonNegativeDecimalNumber}function pluck(prop,list){if(!isarray(list)){return error$2.na}return map(list,function(d){return d[prop]})}function some(needle,list){if(isblank(needle)&&isblank(list)){return error$2.na}if(!isarray(list)){return error$2.na}return list.some(function(n){return eq(n,needle)})}function sort(ref){for(var _len18=arguments.length,criteria=Array(_len18>1?_len18-1:0),_key18=1;_key18<_len18;_key18++){criteria[_key18-1]=arguments[_key18]}var makeComparer=function makeComparer(){return function(a,b){var result=0;for(var i=0;i<criteria.length;i=i+2){if(result!==0)continue;var field=typeof criteria[i]==="string"?criteria[i]:criteria[i]-1,order=criteria[i+1];if(a[field]<b[field]){result=order?-1:1}if(a[field]>b[field]){result=order?1:-1}}return result}};if(!isarray(ref)){return error$2.na}return ref.sort(makeComparer())}function unflatten(ref){var len=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;if(!isarray(ref)){return error$2.value}return reduce(ref,function(p,v,i){if(i===0||i%len===0){p=p.concat([[]])}var lastIndex=p.length-1;p[lastIndex]=p[lastIndex].concat(v);return p},[])}function unique(array){return reduce(array,function(p,c){if(p.indexOf(c)<0)p.push(c);return p},[])}function changed(a,b){var keysA=keys(a),keysB=keys(b);return unique(keysA.filter(function(n){return a[n]!==b[n]}).concat(keysB.filter(function(n){return a[n]!==b[n]})))}function diff(a,b){var keysA=keys(a),keysB=keys(b),InA=keysB.filter(function(n){return keysA.indexOf(n)>-1}),NotInA=keysB.filter(function(n){return keysA.indexOf(n)===-1}),NotInB=keysA.filter(function(n){return keysB.indexOf(n)===-1}),Diff=InA.filter(function(n){return a[n]!==b[n]});return{unique_left:NotInA,unique_right:NotInB,diff:reduce(Diff,function(x,y){var diff={};diff[y]={left:a[y],right:b[y]};return assign({},x,diff)},{})}}function select(fields,body){if(!body||"object"!=(typeof body==="undefined"?"undefined":_typeof(body)))return;if(!fields)return;if("string"==typeof fields)fields=fields.split(/ *, */);if(isarray(body)){return body.map(function(obj){return reduce(fields,function(ret,key){ret[key]=obj[key];return ret},{})});return}return reduce(fields,function(ret,key){ret[key]=body[key];return ret},{})}function clean(obj){var keys$$=keys(obj).filter(function(n){return!isblank(obj[n])});return select(keys$$,obj)}function get(p,o){return o[p]}function base(number,radix){var min_length=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;number=numbervalue(number);radix=numbervalue(radix);min_length=numbervalue(min_length);min_length=min_length===undefined?0:min_length;var result=number.toString(radix);return new Array(Math.max(min_length+1-result.length,0)).join("0")+result}function cellindex(row,col){return Math.floor(row*MaxCols+col)}function ceiling(number,significance,mode){significance=significance===undefined?1:Math.abs(significance);mode=mode||0;number=numbervalue(number);significance=numbervalue(significance);mode=numbervalue(mode);if(significance===0){return 0}var precision=-Math.floor(Math.log(significance)/Math.log(10));if(number>=0){return round(Math.ceil(number/significance)*significance,precision)}else{if(mode===0){return-round(Math.floor(Math.abs(number)/significance)*significance,precision)}else{return-round(Math.ceil(Math.abs(number)/significance)*significance,precision)}}}function columnnumber(column){if(!istext(column)){return error$2.value}var s=0,secondPass;if(column.length>0){s=column.charCodeAt(0)-"A".charCodeAt(0);for(var i=1;i<column.length;i++){s+=1;s*=26;s+=column.charCodeAt(i)-"A".charCodeAt(0);secondPass=true}return s}return error$2.value}function column(value){if(!isref(value)){return error$2.value}return columnnumber(value.column)+1}function columnletter(index){if(!isnumber(index)){return error$2.value}var converted="",secondPass=false,remainder,value=Math.abs(index);do{remainder=value%26;if(secondPass){remainder--}converted=String.fromCharCode(remainder+"A".charCodeAt(0))+converted;value=Math.floor((value-remainder)/26);secondPass=true}while(value>0);return converted}function decodebase64(str){if(typeof window!=="undefined"&&typeof atob!=="undefined"){return window.atob(str)}else if(typeof module!=="undefined"&&module.exports){return new Buffer(str,"base64").toString()}else{var InvalidCharacterError=function InvalidCharacterError(message){this.message=message};var _atob=function _atob(input){var str=String(input).replace(/=+$/,"");if(str.length%4==1){throw new InvalidCharacterError("'atob' failed: The string to be decoded is not correctly encoded.")}for(var bc=0,bs,buffer,idx=0,output="";buffer=str.charAt(idx++);~buffer&&(bs=bc%4?bs*64+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0){buffer=chars.indexOf(buffer)}return output};var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";InvalidCharacterError.prototype=new Error;InvalidCharacterError.prototype.name="InvalidCharacterError";return _atob(str)}}function decodejwt(token){function b64DecodeUnicode(str){return decodeURIComponent(Array.prototype.map.call(decodebase64(str),function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""))}return JSON.parse(b64DecodeUnicode(token.split(".")[1]))}function even(number){return ceiling(number,-2,-1)}function floor(value,significance){significance=significance||1;if(value>0&&significance<0){return error$2.num}if(value>=0){return Math.floor(value/significance)*significance}else{return Math.ceil(value/significance)*significance}}function group(list){for(var _len19=arguments.length,fields=Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++){fields[_key19-1]=arguments[_key19]}return reduce(list,function(acc,item){var parent=undefined,key=void 0;fields.forEach(function(currentField,index){key=item[currentField];if(index===fields.length-1){if(!parent){if(!acc[key]){acc[key]=[]}acc[key].push(item)}else{if(!parent[key]){parent[key]=[]}parent[key].push(item)}}else{if(!parent){acc[key]=acc[key]||{};parent=acc[key]}else{parent[key]=parent[key]||{};parent=parent[key]}}});return acc},{})}function guid(){var guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)});return guid}function int(value){return Math.floor(value)}function index2row(index){return Math.floor(index/MaxCols)}function index2col(index){return index-index2row(index)*MaxCols}function numbers(){for(var _len20=arguments.length,values=Array(_len20),_key20=0;_key20<_len20;_key20++){values[_key20]=arguments[_key20]}return reduce(values,function(p,v){return isnumber(v)?p.concat(v):p},[])}function ref$1(top,bottom){if(!isnumber(top)&&!isfunction(top)){return error$2.value}if(isblank(bottom)){bottom=top}var getTop=function getTop(){return isfunction(top)?top():top};var getBottom=function getBottom(){return isfunction(bottom)?bottom():bottom};return{get _isref(){return true},get top(){return getTop()},get bottom(){return getBottom()},get row(){return index2row(getTop())+1},get rowIndex(){return index2row(getTop())},get column(){return columnletter(index2col(getTop()))},get columnIndex(){return index2col(getTop())},get bottomRow(){return index2row(getBottom())+1},get bottomRowIndex(){return index2row(getBottom())},get bottomColumn(){return columnletter(index2col(getBottom()))},get bottomColumnIndex(){return index2col(getBottom())},hit:function hit(index){if(index<0)return error$2.na;return index>=getTop()&&index<=getBottom()},get size(){return 1+(getBottom()-getTop())},get cells(){return Array.apply(getTop(),Array(1+(getBottom()-getTop()))).map(function(x,y){return y+getTop()})},get rows(){return unique(Array.apply(getTop(),Array(1+(getBottom()-getTop()))).map(function(x,y){return index2row(y+getTop())}))}}}var cond=branch;var ifs=branch;var ifBlank=ifblank;var ifEmpty=ifempty;var ifError=iferror;var ifNA=ifna;var isArray=isarray;var isBlank=isblank;var isbool=isboolean;var isBoolean=isboolean;var isBool=isboolean;var isDate=isdate;var isEmail=isemail;var isEmpty=isempty;var isError=iserror;var isEven=iseven;var isFalsy=isfalsy;var isFunction=isfunction;var isLeapYear=isleapyear;var isObject=isobject;var isNA=isna;var isNaN$1=isnan;var isNumber=isnumber;var isOdd=isodd;var isoWeekNum=isoweeknum;var isRef=isref;var isText=istext;var isTruthy=istruthy;var isURL=isurl;var isWholeNumber=iswholenumber;var isInteger=iswholenumber;var concat=concatenate;var numberValue=numbervalue;var parseBool=parsebool;var parseDate=parsedate;var parseQuery=parsequery;var template=substituteAll;var dateValue=datevalue;var cellIndex=cellindex;var columnLetter=columnletter;var decodeBase64=decodebase64;var atob=decodebase64;var decodeJWT=decodejwt;var functions={run:run,compile:compile,abs:abs,accrint:accrint,acos:acos,acosh:acosh,acot:acot,acoth:acoth,asin:asin,asinh:asinh,atan:atan,atan2:atan$1,atanh:atan$2,add:add,and:and,atob:atob,average:average,base:base,bin2dec:bin2dec,branch:branch,camelcase:camelcase,ceiling:ceiling,cellIndex:cellIndex,cellindex:cellindex,changed:changed,char:char,choose:choose,clean:clean,code:code,column:column,columnLetter:columnLetter,columnletter:columnletter,columnnumber:columnnumber,concat:concat,concatenate:concatenate,cond:cond,cos:cos,date:date,dateValue:dateValue,datedif:datedif,datevalue:datevalue,day:day,days360:days360,dec2bin:dec2bin,decodeBase64:decodeBase64,decodeJWT:decodeJWT,decodebase64:decodebase64,decodejwt:decodejwt,degrees:degrees,diff:diff,divide:divide,edate:edate,eomonth:eomonth,eq:eq,even:even,exact:exact,filter:filter,find:find,flatten:flatten,floor:floor,fv:fv,get:get,group:group,gt:gt,gte:gte,guid:guid,hlookup:hlookup,hour:hour,ifBlank:ifBlank,ifEmpty:ifEmpty,ifError:ifError,ifNA:ifNA,ifblank:ifblank,ifempty:ifempty,iferror:iferror,ifna:ifna,ifs:ifs,includes:includes,index:index,index2col:index2col,index2row:index2row,int:int,isArray:isArray,isBlank:isBlank,isBool:isBool,isBoolean:isBoolean,isDate:isDate,isEmail:isEmail,isEmpty:isEmpty,isError:isError,isEven:isEven,isFunction:isFunction,isInteger:isInteger,isLeapYear:isLeapYear,isObject:isObject,isNA:isNA,isNumber:isNumber,isOdd:isOdd,isRef:isRef,isText:isText,isWholeNumber:isWholeNumber,isarray:isarray,isblank:isblank,isbool:isbool,isboolean:isboolean,isdate:isdate,isemail:isemail,isempty:isempty,iserror:iserror,iseven:iseven,isfalsy:isfalsy,isfunction:isfunction,isleapyear:isleapyear,isobject:isobject,isna:isna,isnan:isnan,isnumber:isnumber,isoWeekNum:isoWeekNum,isodd:isodd,isoweeknum:isoweeknum,isref:isref,istext:istext,istruthy:istruthy,isurl:isurl,iswholenumber:iswholenumber,join:join,left:left,len:len,lookup:lookup,lower:lower,lt:lt,lte:lte,map:map,match:match,max:max,min:min,minute:minute,month:month,multiply:multiply,n:n,ne:ne,not:not,now:now,nper:nper,npv:npv,numberValue:numberValue,numbers:numbers,numbervalue:numbervalue,oct2dec:oct2dec,or:or,parseBool:parseBool,parseDate:parseDate,parseQuery:parseQuery,parsebool:parsebool,parsedate:parsedate,parsequery:parsequery,pi:pi$1,pluck:pluck,pmt:pmt,power:power,proper:proper,pv:pv,query:query,reduce:reduce,ref:ref$1,replace:replace,rept:rept,right:right,round:round,roundup:roundup,search:search,second:second,select:select,serial:serial,sin:sin,snakecase:snakecase,some:some,sort:sort,split:split,substitute:substitute,substituteAll:substituteAll,subtract:subtract,sum:sum,surroundKeys:surroundKeys,tan:tan,tau:tau,template:template,text:text,time:time,timevalue:timevalue,today:today,trim:trim,trunc:trunc,unflatten:unflatten,unique:unique,upper:upper,vlookup:vlookup,xor:xor,year:year,yearfrac:yearfrac};return functions});
